var Imported=Imported||{};Imported.AXY_Spine=!0;var AXY=AXY||{};AXY.Spine=AXY.Spine||{},AXY.Spine.Parameters=PluginManager.parameters("AXY_Spine"),AXY.Spine.Param=AXY.Spine.Param||{},AXY.Spine.Param.X=String(AXY.Spine.Parameters.X),AXY.Spine.Param.Y=String(AXY.Spine.Parameters.Y),AXY.Spine.Param.scalex=parseFloat(AXY.Spine.Parameters.scalex),AXY.Spine.Param.scaley=parseFloat(AXY.Spine.Parameters.scaley),AXY.Spine.Param.opacity=parseFloat(AXY.Spine.Parameters.opacity),AXY.Spine.Param.rotation=parseFloat(AXY.Spine.Parameters.rotation),AXY.Spine.Param.path=String(AXY.Spine.Parameters.path),AXY.Spine.Param.loop="true"===AXY.Spine.Parameters.loop.toLowerCase(),AXY.Spine.Param.spine=[],AXY.Spine.Param.spinecontainer=[],AXY.Spine.Param.SVActor=[],AXY.Spine.Param.spineObj=[];var AXY_Spine={show:function(){var AXYSpineArgs=arguments[0]?arguments[0]:{},filename=AXYSpineArgs.filename?AXYSpineArgs.filename:"",objectname=filename.replace("-",""),id=AXYSpineArgs.id?AXYSpineArgs.id:1,x=null!=AXYSpineArgs.x?eval(AXYSpineArgs.x):eval(AXY.Spine.Param.X),y=null!=AXYSpineArgs.y?eval(AXYSpineArgs.y):eval(AXY.Spine.Param.Y),scalex=null!=AXYSpineArgs.scalex?AXYSpineArgs.scalex:AXY.Spine.Param.scalex,scaley=null!=AXYSpineArgs.scaley?AXYSpineArgs.scaley:AXY.Spine.Param.scaley,opacity=null!=AXYSpineArgs.opacity?AXYSpineArgs.opacity:AXY.Spine.Param.opacity,rotation=null!=AXYSpineArgs.rotation?AXYSpineArgs.rotation:AXY.Spine.Param.rotation,action=AXYSpineArgs.action?AXYSpineArgs.action:"",loop=null!=AXYSpineArgs.loop?AXYSpineArgs.loop:AXY.Spine.Param.loop;if(action)if(filename){filename=-1!=filename.indexOf("url=")?filename.replace("url=",""):AXY.Spine.Param.path+filename+".json";var assetsToLoader=[filename];AXY.Spine.Param.spineObj[AXYSpineArgs.filename]?SceneManager._scene.addChild(AXY.Spine.Param.spineObj[AXYSpineArgs.filename]):PIXI.loader.add(AXYSpineArgs.filename,filename).load(onAssetsLoaded)}else $.toaster({message:"Please specify the filename!"});else $.toaster({message:"Please specify the action!"});function onAssetsLoaded(loader,res){AXY.Spine.Param.spineObj[AXYSpineArgs.filename]=new PIXI.spine.Spine(res[AXYSpineArgs.filename].spineData),AXY.Spine.Param.spinecontainer[id]||(AXY.Spine.Param.spinecontainer[id]=new PIXI.Container,SceneManager._scene.addChild(AXY.Spine.Param.spinecontainer[id])),AXY.Spine.Param.spine[id]&&AXY.Spine.Param.spine[id].filename==filename||(AXY.Spine.Param.spinecontainer[id].removeChild(AXY.Spine.Param.spine[id]),AXY.Spine.Param.spine[id]=AXY.Spine.Param.spineObj[AXYSpineArgs.filename],AXY.Spine.Param.spine[id].id=id,AXY.Spine.Param.spine[id].name="AXYSPINE",AXY.Spine.Param.spine[id].filename=filename,AXY.Spine.Param.spinecontainer[id].addChild(AXY.Spine.Param.spine[id])),AXY.Spine.Param.spinecontainer[id].position.x=x,AXY.Spine.Param.spinecontainer[id].position.y=y,AXY.Spine.Param.spine[id].scale.x=scalex,AXY.Spine.Param.spine[id].scale.y=scaley,AXY.Spine.Param.spine[id].rotation=rotation,AXY.Spine.Param.spine[id].alpha=opacity,AXY.Spine.Param.spine[id].state.setAnimation(0,action,loop),AXY.Spine.Param.spine[id].action=action}},action:function(){var AXYSpineArgs=arguments[0]?arguments[0]:{},id=AXYSpineArgs.id?AXYSpineArgs.id:1,x=null!=AXYSpineArgs.x?eval(AXYSpineArgs.x):null,y=null!=AXYSpineArgs.y?eval(AXYSpineArgs.y):null,scalex=null!=AXYSpineArgs.scalex?AXYSpineArgs.scalex:null,scaley=null!=AXYSpineArgs.scaley?AXYSpineArgs.scaley:null,opacity=null!=AXYSpineArgs.opacity?AXYSpineArgs.opacity:null,rotation=null!=AXYSpineArgs.rotation?AXYSpineArgs.rotation:null,action=AXYSpineArgs.action?AXYSpineArgs.action:"",type=AXYSpineArgs.type?AXYSpineArgs.type:"temp";if(action){if(AXY.Spine.Param.spinecontainer[id]&&AXY.Spine.Param.spine[id])switch(x&&(AXY.Spine.Param.spinecontainer[id].position.x=x),y&&(AXY.Spine.Param.spinecontainer[id].position.y=y),scalex&&(AXY.Spine.Param.spine[id].scale.x=scalex),scaley&&(AXY.Spine.Param.spine[id].scale.y=scaley),rotation&&(AXY.Spine.Param.spine[id].rotation=rotation),opacity&&(AXY.Spine.Param.spine[id].alpha=opacity),type){case"loop":AXY.Spine.Param.spine[id].state.setAnimation(0,action,!0),AXY.Spine.Param.spine[id].action=action;break;case"end":AXY.Spine.Param.spine[id].state.setAnimation(0,action,!1);break;case"temp":default:AXY.Spine.Param.spine[id].state.setAnimation(0,action,!1),AXY.Spine.Param.spine[id].state.addAnimation(0,AXY.Spine.Param.spine[id].action,!0,0)}}else $.toaster({message:"Please specify the action!"})},remove:function(){var id=arguments[0]?arguments[0]:1;AXY.Spine.Param.spinecontainer[id]&&AXY.Spine.Param.spine[id]&&(SceneManager._scene.removeChild(AXY.Spine.Param.spinecontainer[id]),AXY.Spine.Param.spinecontainer[id]=null,AXY.Spine.Param.spine[id]=null)},removeall:function(){console.log(SceneManager._scene),AXY.Spine.Param.spinecontainer.forEach((function(val,index,arr){SceneManager._scene.removeChild(AXY.Spine.Param.spinecontainer[index]),AXY.Spine.Param.spinecontainer[index]=null,AXY.Spine.Param.spine[index]=null}))}};Spriteset_Battle.prototype.createActors=function(){this._actorSprites=[];for(var i=0;i<$gameParty.maxBattleMembers();i++){var actorId=$gameParty._actors[i];if(this._actorSprites[i]=new Sprite_Actor,actorId){var AXYSpineSVActorFileName=$dataActors[actorId].meta.axyspine;console.log(AXYSpineSVActorFileName);var tempScaleX=$dataActors[actorId].meta.axyspine_scalex,tempScaleY=$dataActors[actorId].meta.axyspine_scaley;if(AXYSpineSVActorFileName=-1!=AXYSpineSVActorFileName.indexOf("url=")?AXYSpineSVActorFileName.replace("url=",""):AXY.Spine.Param.path+AXYSpineSVActorFileName+".json"){AXY.Spine.Param.SVActor[actorId]&&delete AXY.Spine.Param.SVActor[actorId];var assetsToLoader=[AXYSpineSVActorFileName];loader=new PIXI.AssetLoader(assetsToLoader),loader.onComplete=function(){AXY.Spine.Param.SVActor[actorId]=new PIXI.Spine(AXYSpineSVActorFileName)},loader.load(),AXY.Spine.Param.SVActor[actorId]&&($gameActors.actor(actorId).isAXYSpineSVActor=!0,tempScaleX&&(AXY.Spine.Param.SVActor[actorId].scale.x=tempScaleX),tempScaleY&&(AXY.Spine.Param.SVActor[actorId].scale.y=tempScaleY),this._actorSprites[i].addChild(AXY.Spine.Param.SVActor[actorId]))}}this._battleField.addChild(this._actorSprites[i])}};var AXY_Spine_alias_Game_Actor_prototype_performCollapse=Game_Actor.prototype.performCollapse;Game_Actor.prototype.performCollapse=function(){if(Game_Battler.prototype.performCollapse.call(this),$gameParty.inBattle())if(!0===this.isAXYSpineSVActor){var actorId=this._actorId;SoundManager.playActorCollapse(),console.log(AXY.Spine.Param.SVActor[this._actorId]);var AXYSingleImgSVActorFileName=$dataActors[actorId].meta.axysingle_death?$dataActors[actorId].meta.axysingle_death:$dataActors[actorId].meta.axysingle,AXYSingleImgSVActorScaleX=$dataActors[actorId].meta.axysingle_death_scalex,AXYSingleImgSVActorScaleY=$dataActors[actorId].meta.axysingle_death_scaley,AXYSingleImgSVActorRotation=$dataActors[actorId].meta.axysingle_death_rotation,AXYSingleImgSVActorHUE=$dataActors[actorId].meta.axysingle_death_hue?$dataActors[actorId].meta.axysingle_death_hue:0;AXYSingleImgSVActorScaleX&&(AXY.Spine.Param.SVActor[actorId].scale.x=AXYSingleImgSVActorScaleX),AXYSingleImgSVActorScaleY&&(AXY.Spine.Param.SVActor[actorId].scale.y=AXYSingleImgSVActorScaleY),AXYSingleImgSVActorRotation&&(AXY.Spine.Param.SVActor[actorId].rotation=AXYSingleImgSVActorRotation),AXYSingleImgSVActorFileName&&(AXY.Spine.Param.SVActor[this._actorId].bitmap=ImageManager.loadSvActor(AXYSingleImgSVActorFileName,AXYSingleImgSVActorHUE))}else AXY_Spine_alias_Game_Actor_prototype_performCollapse.call(this)};